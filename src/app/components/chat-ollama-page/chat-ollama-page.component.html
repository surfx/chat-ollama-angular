<app-mensagens-overlay #mensagensOverlayComponent></app-mensagens-overlay>

<div class="container">
    <header class="header">
        <h1>
            <img src="/imagens/ollama.png" alt="Chat Ollama">
            <i class="fa-regular fa-comment"></i> Chat Ollama
        </h1>

        <div>
            <label for="config_ollama_api">Api Ollama</label>
            <input type="text" id="config_ollama_api" [(ngModel)]="configuracoes!.ollama_api" />
            <button (click)="btnSalvarConfiguracoes()" [disabled]="!isServerOnline()">Salvar</button>
        </div>

    </header>
    <main class="main" id="response">
        <div class="div_mensagem" id="msg_app_mensagem">
            <app-mensagens #mensagemComponente></app-mensagens>
        </div>
        <app-chat-display #appchatdisplay></app-chat-display>
    </main>
    <footer class="footer">
        
        <div class="model-config">
            <select [(ngModel)]="selectedModel" id="selModelos" [disabled]="!isServerOnline()">
                @if (!modelos || modelos.length <= 0) {
                    <option value="loading">Loading models...</option>
                } @else {
                    @for (modelo of modelos; track $index) {
                        <option [value]="modelo.name">{{ modelo.name }}</option>
                    }
                }
            </select>
            <div class="config-server-status">
                @if(!isServerOnline()) {
                    <p class="server-offline">
                        <i class="fa-solid fa-xmark"></i> ðŸ¦™ Offline
                    </p>
                } @else {
                    <p class="server-online">
                        <i class="fa-solid fa-check"></i> ðŸ¦™ Online
                    </p>
                }
            </div>
            <div class="config-chat-generate">
                <input type="radio" id="chat" name="chat_generate" value="chat" [(ngModel)]="configuracoes.configuracoes!.modo">
                <label for="chat">Chat</label>
                <input type="radio" id="generate" name="chat_generate" value="generate" [(ngModel)]="configuracoes.configuracoes!.modo">
                <label for="generate">Generate</label>
            </div>
            <div class="config-temperature">
                <label for="temperature">Temperatura</label>
                <input type="range" id="temperature" min="0" max="2" step="0.1" [(ngModel)]="configuracoes.configuracoes!.temperatura" [disabled]="!isServerOnline()"> {{configuracoes.configuracoes!.temperatura}}
            </div>
        </div>
        <div class="input-section">
            <textarea placeholder="Digite sua mensagem..." [(ngModel)]="userPrompt" id="txtUserPrompt" [disabled]="!isServerOnline()"></textarea>
            <div class="btns_limpar_abortar">
                <button (click)="btnLimparMensagem()" id="btnLimpar">Limpar</button>
                <button (click)="btnAbortarMensagem()" id="btnAbortar">Abortar</button>
            </div>
            <div class="btn_enviar_imagem">
                <input id="fileInputImage" type="file" (change)="onFileSelected($event)" multiple style="display: none;"
                    [disabled]="configuracoes.configuracoes!.modo !== 'generate'">
                <button id="btnEnviarImagem" onclick="javascript:document.getElementById('fileInputImage').click();"
                    [disabled]="configuracoes.configuracoes!.modo !== 'generate'">
                    <i class="fa-regular fa-image"></i>
                </button>
            </div>
            <button (click)="btnEnviarMensagem()" id="btnEnviar" [disabled]="!isServerOnline()">Enviar</button>
        </div>

    </footer>
</div>